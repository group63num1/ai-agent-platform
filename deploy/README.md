# è‡ªåŠ¨åŒ–éƒ¨ç½²è¯´æ˜

æœ¬é¡¹ç›®åŒ…å«å®Œæ•´çš„è‡ªåŠ¨åŒ–éƒ¨ç½²é…ç½®ï¼Œæ”¯æŒä¸€é”®éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
ai-agent-platform/
â”œâ”€â”€ frontend/          # å‰ç«¯é¡¹ç›® (Vue3)
â”œâ”€â”€ backend/           # åç«¯é¡¹ç›® (Spring Boot)
â”œâ”€â”€ database/          # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ ai-agent/          # AI ä»£ç†æœåŠ¡ (FastAPI)
â””â”€â”€ deploy/            # è‡ªåŠ¨åŒ–éƒ¨ç½²é…ç½®
    â”œâ”€â”€ docker-compose.yml    # Docker Compose é…ç½®
    â”œâ”€â”€ deploy.sh             # éƒ¨ç½²è„šæœ¬
    â”œâ”€â”€ Makefile              # ç®€åŒ–å‘½ä»¤æ¥å£
    â””â”€â”€ env.example           # ç¯å¢ƒå˜é‡æ¨¡æ¿
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿æœåŠ¡å™¨å·²å®‰è£…ï¼š
- Docker (>= 20.10)
- Docker Compose (>= 2.0)

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
cd deploy
cp env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œæ ¹æ®å®é™…æƒ…å†µä¿®æ”¹é…ç½®
```

### 3. ä¸€é”®éƒ¨ç½²

```bash
# æ–¹å¼ä¸€ï¼šä½¿ç”¨ Makefileï¼ˆæ¨èï¼‰
make deploy

# æ–¹å¼äºŒï¼šç›´æ¥è¿è¡Œè„šæœ¬
./deploy.sh
```

## ğŸ“‹ éƒ¨ç½²è„šæœ¬åŠŸèƒ½

`deploy.sh` è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. âœ… **ç¯å¢ƒæ£€æŸ¥** - æ£€æŸ¥ Docker å’Œ Docker Compose
2. âœ… **Maven ç¼“å­˜å‡†å¤‡** - åˆ›å»º Maven ç¼“å­˜å·
3. âœ… **æ„å»ºåç«¯ JAR** - ä½¿ç”¨ Maven å®¹å™¨æ„å»º Spring Boot åº”ç”¨
4. âœ… **æ„å»º Docker é•œåƒ** - æ„å»ºæ‰€æœ‰æœåŠ¡çš„é•œåƒ
5. âœ… **æ¸…ç†æ—§æœåŠ¡** - åœæ­¢å¹¶åˆ é™¤æ—§å®¹å™¨
6. âœ… **å¯åŠ¨æ–°æœåŠ¡** - å¯åŠ¨æ‰€æœ‰æœåŠ¡
7. âœ… **éªŒè¯éƒ¨ç½²** - æ£€æŸ¥æœåŠ¡çŠ¶æ€

## ğŸ³ æœåŠ¡è¯´æ˜

éƒ¨ç½²åï¼Œä»¥ä¸‹æœåŠ¡ä¼šè‡ªåŠ¨å¯åŠ¨ï¼š

| æœåŠ¡ | å®¹å™¨å | ç«¯å£ | è¯´æ˜ |
|------|--------|------|------|
| MySQL | ai-agent-mysql | 3306 | æ•°æ®åº“æœåŠ¡ |
| PHPMyAdmin | ai-agent-phpmyadmin | 8081 | æ•°æ®åº“ç®¡ç†å·¥å…· |
| Backend | ai-agent-backend | 8080 | Spring Boot åç«¯ API |
| AI Agent | ai-agent-ai-agent | 8000 | FastAPI AI ä»£ç†æœåŠ¡ |
| Frontend | ai-agent-web-admin | 80 | Vue3 å‰ç«¯ç®¡ç†ç•Œé¢ |

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### ä½¿ç”¨ Makefileï¼ˆæ¨èï¼‰

```bash
# æŸ¥çœ‹å¸®åŠ©
make help

# éƒ¨ç½²ç›¸å…³
make deploy              # ä¸€é”®éƒ¨ç½²
make build              # æ„å»ºæ‰€æœ‰é•œåƒ
make build-backend      # åªæ„å»ºåç«¯
make build-frontend     # åªæ„å»ºå‰ç«¯
make build-ai-agent     # åªæ„å»º AI Agent

# æœåŠ¡æ§åˆ¶
make start              # å¯åŠ¨æ‰€æœ‰æœåŠ¡
make stop               # åœæ­¢æ‰€æœ‰æœåŠ¡
make restart            # é‡å¯æ‰€æœ‰æœåŠ¡
make ps                 # æŸ¥çœ‹æœåŠ¡çŠ¶æ€

# æ—¥å¿—æŸ¥çœ‹
make logs               # æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
make logs-backend       # æŸ¥çœ‹åç«¯æ—¥å¿—
make logs-frontend      # æŸ¥çœ‹å‰ç«¯æ—¥å¿—
make logs-ai-agent      # æŸ¥çœ‹ AI Agent æ—¥å¿—
make logs-mysql         # æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—

# è¿ç»´ç®¡ç†
make status             # æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€
make backup             # å¤‡ä»½æ•°æ®åº“
make clean              # æ¸…ç†æ‰€æœ‰å®¹å™¨å’Œé•œåƒ
```

### ä½¿ç”¨ Docker Compose

```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# åœæ­¢æœåŠ¡
docker-compose down

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f [service_name]

# é‡å¯æœåŠ¡
docker-compose restart [service_name]

# æŸ¥çœ‹çŠ¶æ€
docker-compose ps
```

## ğŸŒ è®¿é—®åœ°å€

éƒ¨ç½²æˆåŠŸåï¼Œå¯é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **å‰ç«¯ç®¡ç†ç«¯**: http://your-server-ip
- **åç«¯ API**: http://your-server-ip:8080
- **API æ–‡æ¡£**: http://your-server-ip:8080/doc.html
- **AI Agent API**: http://your-server-ip:8000
- **AI Agent æ–‡æ¡£**: http://your-server-ip:8000/docs
- **PHPMyAdmin**: http://your-server-ip:8081

## âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®

ä¸»è¦ç¯å¢ƒå˜é‡è¯´æ˜ï¼ˆè¯¦è§ `env.example`ï¼‰ï¼š

### æ•°æ®åº“é…ç½®
- `MYSQL_DATABASE`: æ•°æ®åº“åç§°
- `MYSQL_ROOT_PASSWORD`: MySQL root å¯†ç 

### æœåŠ¡ç«¯å£
- `BACKEND_PORT`: åç«¯æœåŠ¡ç«¯å£ï¼ˆé»˜è®¤ 8080ï¼‰
- `AI_AGENT_PORT`: AI Agent æœåŠ¡ç«¯å£ï¼ˆé»˜è®¤ 8000ï¼‰
- `WEB_ADMIN_PORT`: å‰ç«¯æœåŠ¡ç«¯å£ï¼ˆé»˜è®¤ 80ï¼‰

### AI Agent é…ç½®
- `AI_AGENT_DEBUG`: è°ƒè¯•æ¨¡å¼ï¼ˆtrue/falseï¼‰
- `AI_AGENT_LOG_LEVEL`: æ—¥å¿—çº§åˆ«ï¼ˆINFO/DEBUG/WARNINGï¼‰
- `AI_AGENT_CORS_ORIGINS`: CORS å…è®¸çš„æºï¼ˆå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼‰

## ğŸ” æ•…éšœæ’æŸ¥

### æŸ¥çœ‹æœåŠ¡æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
make logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
make logs-backend
make logs-ai-agent
```

### æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
make ps

# æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€
make status
```

### å¸¸è§é—®é¢˜

1. **ç«¯å£è¢«å ç”¨**
   - ä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„ç«¯å£é…ç½®

2. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ MySQL å®¹å™¨æ˜¯å¦æ­£å¸¸å¯åŠ¨
   - æ£€æŸ¥æ•°æ®åº“å¯†ç é…ç½®æ˜¯å¦æ­£ç¡®

3. **æ„å»ºå¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆéœ€è¦ä¸‹è½½ä¾èµ–ï¼‰
   - æŸ¥çœ‹æ„å»ºæ—¥å¿—ï¼š`docker-compose build --no-cache`

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡éƒ¨ç½²**ï¼šé¦–æ¬¡éƒ¨ç½²å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼ˆä¸‹è½½ä¾èµ–ï¼‰
2. **æ•°æ®æŒä¹…åŒ–**ï¼šæ•°æ®åº“æ•°æ®å­˜å‚¨åœ¨ Docker å·ä¸­ï¼Œåˆ é™¤å®¹å™¨ä¸ä¼šä¸¢å¤±æ•°æ®
3. **å¤‡ä»½æ•°æ®**ï¼šå®šæœŸä½¿ç”¨ `make backup` å¤‡ä»½æ•°æ®åº“
4. **ç”Ÿäº§ç¯å¢ƒ**ï¼šç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹é»˜è®¤å¯†ç å’Œé…ç½®

## ğŸ”„ æ›´æ–°éƒ¨ç½²

å½“ä»£ç æ›´æ–°åï¼Œé‡æ–°éƒ¨ç½²ï¼š

```bash
# æ–¹å¼ä¸€ï¼šä½¿ç”¨ Makefile
make deploy

# æ–¹å¼äºŒï¼šæ‰‹åŠ¨æ›´æ–°
git pull
cd deploy
./deploy.sh
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- æœåŠ¡æ—¥å¿—ï¼š`make logs`
- Docker æ—¥å¿—ï¼š`docker-compose logs`
- å®¹å™¨çŠ¶æ€ï¼š`docker-compose ps`

